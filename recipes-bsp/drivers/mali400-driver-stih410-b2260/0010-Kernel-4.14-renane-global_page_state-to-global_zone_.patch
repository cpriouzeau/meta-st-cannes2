From 8a88165a2c921ca0dc588784884b9c8bce551a2b Mon Sep 17 00:00:00 2001
From: Christophe Priouzeau <christophe.priouzeau@st.com>
Date: Sun, 12 Nov 2017 18:35:58 +0100
Subject: [PATCH 10/10] Kernel 4.14 renane global_page_state to
 global_zone_page_state

Signed-off-by: Christophe Priouzeau <christophe.priouzeau@st.com>
---
 src/devicedrv/mali/linux/mali_memory_swap_alloc.c | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

diff --git a/src/devicedrv/mali/linux/mali_memory_swap_alloc.c b/src/devicedrv/mali/linux/mali_memory_swap_alloc.c
index 068e4d0..8b70501 100755
--- a/src/devicedrv/mali/linux/mali_memory_swap_alloc.c
+++ b/src/devicedrv/mali/linux/mali_memory_swap_alloc.c
@@ -248,7 +248,7 @@ static void mali_mem_swap_swapped_bkend_pool_shrink(_mali_mem_swap_pool_shrink_t
 	}
 
 	/* Get system free pages number. */
-	system_free_size = global_page_state(NR_FREE_PAGES) * PAGE_SIZE;
+	system_free_size = global_zone_page_state(NR_FREE_PAGES) * PAGE_SIZE;
 	last_gpu_utilization = _mali_ukk_utilization_gp_pp();
 
 	if ((last_gpu_utilization < gpu_utilization_threshold_value)
@@ -576,7 +576,7 @@ int mali_mem_swap_alloc_pages(mali_mem_swap *swap_mem, u32 size, u32 *bkend_idx)
 		list_add_tail(&m_page->list, &swap_mem->pages);
 	}
 
-	system_free_size = global_page_state(NR_FREE_PAGES) * PAGE_SIZE;
+	system_free_size = global_zone_page_state(NR_FREE_PAGES) * PAGE_SIZE;
 
 	if ((system_free_size < mali_mem_swap_out_threshold_value)
 	    && (mem_backend_swapped_pool_size > (mali_mem_swap_out_threshold_value >> 2))
-- 
2.7.4

